angular.module("DualMultiSelect",["TreeView"]).directive("dualmultiselect",function(){return{restrict:"AE",scope:{inputModel:"=",ngModel:"=",outputAllInfo:"=",recursionCheck:"=",outputAllInfo:"=",outputDuplicate:"=",options:"="},controller:["$scope",function(e){e.options=e.options||{},e.valueProperty=e.options.valueProperty||"id",e.displayProperty=e.options.displayProperty||"text",e.children=e.options.childrenProperty||"children",e.labelSelected=e.options.labelSelected||"已选择的内容",e.labelAll=e.options.labelAll||"待选择内容",e.buttonCheckAll=e.options.buttonCheckAll||"全选",e.buttonDeselectAll=e.options.buttonDeselectAll||"全不选",e.hashObject={};var l={getParentItem:function(l){return e.outputAllInfo?l.$treeView.parentData:e.hashObject[l].$treeView.parentData?e.hashObject[l].$treeView.parentData[e.valueProperty]:void 0},unwrap:function(l){for(var t=0;t<l.length;t++)l[t]=l[t][e.valueProperty]}};e.selectAll=function(){e.ngModel=[],angular.forEach(e.hashObject,function(l){e.ngModel.push(e.outputAllInfo?l:l[e.valueProperty])})},e.deSelectAll=function(){e.ngModel=[]},e.deSelect=function(t){var n;if(e.recursionCheck){n=l.getParentItem(t),angular.isDefined(n)&&-1!==e.ngModel.indexOf(n)&&e.ngModel.splice(e.ngModel.indexOf(n),1);var o=e.outputAllInfo?t:e.hashObject[t];if(o[e.children]&&o[e.children].length){var i=e.outputAllInfo?o[e.children][0]:o[e.children][0][e.valueProperty];if(-1!==e.ngModel.indexOf(i)){for(var a=[],c=0;c<o[e.children].length;c++)a.push(o[e.children][c]);for(;a.length;){o=a.pop();var r=e.outputAllInfo?o:o[e.valueProperty];if(e.ngModel.splice(e.ngModel.indexOf(r),1),o[e.children]&&o[e.children].length)for(c=0;c<o[e.children].length;c++)a.push(o[e.children][c])}}}}e.ngModel.splice(e.ngModel.indexOf(t),1)},e.compareName=function(l,t){return-1!==e.getDisplayName(l).toString().indexOf(t)},e.getDisplayName=function(l){return e.outputAllInfo?l[e.displayProperty]:e.hashObject[l]?e.hashObject[l][e.displayProperty]:void 0}}],templateUrl:"angular-dual-multi-select.tpl"}}),function(){"use strict";angular.module("DualMultiSelect").run(["$templateCache",function(e){e.put("angular-dual-multi-select.tpl",'<div class="dualmultiselect"> \n    <div class="row"> \n        <div class="col-lg-6 col-md-6 col-sm-6"> \n            <label>{{ labelAll }}</label> \n            <button type="button" class="btn btn-default btn-xs" ng-click="selectAll()"> {{buttonCheckAll}} </button> \n            <div class="search-wrap">\n                <input class="form-control input-sm" ng-model="searchLeft">\n            </div>\n            <div class="pool">\n                <tree-view\n                    input-model="inputModel"\n                    ng-model="ngModel"\n                    recursion-check="recursionCheck"\n                    output-duplicate="outputDuplicate"\n                    output-all-info="outputAllInfo"\n                    options="options"\n                    hash-object="hashObject"\n                    filter-model="searchLeft">\n                    <span>{{node[displayProperty]}}</span>\n                </tree-view>\n            </div>\n        </div>\n        <div class="col-lg-6 col-md-6 col-sm-6"> \n            <label>{{ labelSelected }}</label> \n            <button type="button" class="btn btn-default btn-xs" ng-click="deSelectAll()"> {{buttonDeselectAll}} </button>\n            <div class="search-wrap">\n                <input class="form-control input-sm" ng-model="searchRight">\n            </div>\n            <div class="pool">\n                <ul>\n                    <li ng-repeat="item in ngModel | filter:searchRight:compareName"> \n                        <a ng-click="deSelect(item)">\n                            {{ getDisplayName(item) }}\n                        </a>\n                    </li>\n                </ul> \n            </div>\n        </div>\n    </div>\n</div>')}])}();